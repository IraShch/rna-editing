---
title: "50 nodes test results (TNOR3)"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
```

```{r}
library(readr)
library(ggplot2)
library(dplyr)
library(tidyr)

data_file_name <- "/Users/bioinformaticshub/Documents/Ira/soft/neural_net/50nodes_test.tsv"
result_data <- read_tsv(data_file_name)
```

### Model description

1 hidden layer with 50 nodes and tanh activation function. Output activation function -- Relu. Initialization is normal for both layers.

Poisson loss function, RMSprop opimizer, batch size = 4096, n_epoch = 50. 

Data is splitted: 85% train and 15% test.

### Learning process

![loss](/Users/bioinformaticshub/Documents/Ira/soft/neural_net/plots/test_50/50nodes_learning_loss.png)

![mse](/Users/bioinformaticshub/Documents/Ira/soft/neural_net/plots/test_50/50nodes_learning_mse.png)

![mrn](/Users/bioinformaticshub/Documents/Ira/soft/neural_net/plots/test_50/50nodes_learning_mrn.png)

### Squared errors

```{r}
result_data %>%
  select(ends_with("_se")) %>%
  gather(ends_with("_se"), key = "nucleotide", value = "squared_error") %>%
  ggplot() +
  geom_boxplot(aes(nucleotide, squared_error, colour = nucleotide)) +
  theme_bw() +
  labs(title = 'Squared error')

result_data %>%
  select(ends_with("_se")) %>%
  gather(ends_with("_se"), key = "nucleotide", value = "squared_error") %>%
  filter(squared_error < 1000) %>%
  filter(squared_error > 0) %>%
  ggplot() +
  geom_boxplot(aes(nucleotide, squared_error, colour = nucleotide)) +
  theme_bw() +
  labs(title = 'Squared error (filetered)')
```

```{r, echo=TRUE}
summary(result_data$A_se)
summary(result_data$G_se)
summary(result_data$C_se)
summary(result_data$T_se)

result_data %>%
  gather(ends_with("_se"), key = "nucleotide", value = "squared_error") %>%
  select(squared_error) %>%
  summary()
```

### Residual noise

```{r}
result_data %>%
  ggplot() +
  geom_boxplot(aes(1, residual_noise)) +
  theme_bw() +
  labs(title = 'Residual noise (50 nodes NN)')
summary(result_data$residual_noise)
```

% of positions with non-zero residual noise:

```{r}
# % of positions with non-zero residual noise
100 * nrow(filter(result_data, residual_noise > 0)) / nrow(result_data)
```

### Reference position error

```{r}
result_data %>%
  ggplot() +
  geom_boxplot(aes(1, reference_error)) +
  theme_bw() +
  labs(title = 'Reference position error (50 nodes NN)')
result_data %>%
  filter(abs(reference_error) < 100) %>%
  ggplot() +
  geom_boxplot(aes(1, reference_error)) +
  theme_bw() +
  labs(title = 'Reference position error (50 nodes NN)')
```

```{r, echo=TRUE}
summary(result_data$reference_error)
```

```{r}
```